---
layout: post
title: Genetic algorithm for Register Allocation
subtitle: Experiment that gave great insights
tags: [register allocation, LSRA, RyuJIT]
---

Engineering SVE in .NET

## Introduction

128-bits is 16B and 256-bits are 32B

## What is SVE?

SVE an acronym for Scalable Vector Extension is the Arm processor feature that lets you program on vector length that is hardware defined and developers do not have to worry about it. Once the code is written, it doesn't need be recompiled for the future version of hardware that can expand the vector length. There are numerous articles and blog posts that describes SVE. 

Explain difference between non-streaming and streaming mode SVE.

## Predicates

diagrams of predicate register and some operations



## Backend

For adding an instruction set support in a compiler needs to first implement the backed

### SVE encoding

encodings of new instructions and plumbing the creating of those instructions through out the code base of a compiler. This is not a big task for handful of instructions. However, for SVE, we set an ambitious goal of implementing 1123 instructions.

tool, formatting, instruction names, encoding

### Register allocation to handle more than 64 registers

### prolog and epilog handling

## Frontend

### SVE APIs

### Vector<T>

### VectorToMask and MaskToVector conversions

### Conditional Select

### Delay free registers

### movprfx instruction

### Predicated, Unpredicated, both

## FFR register

## Diagnostics

## Context switches

## Debugging

## Testing 

stress test running locally

### Partners

## Hardware availability

Currently SVE is available in very limited hardwares, but vendors are pushing towards introducing SVE. Microsoft Azure recently released Arm offering of Cobalt 100 that has non-streaming SVE feature. Amazon's AWS has Graviton 3 that comes with 2 x 16B VL, Graviron 4 comes with 16B vector length, Apple's M4 has 64B vector length and supports streaming SVE and SME features. And there is Fijitsu's super computer that offers SVE 64B VL.

### Future

- streaming SVE and SME
- True VL agnostic


### References

good references that explain SVE features in details along with the coding examples.